theme_minimal() +
geom_text_repel(aes(label=team)) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50)) +
geom_vline(aes(xintercept=50)) +
xlim(0,100) + ylim(0,100)
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=team), size=8) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100)
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=team), size=1) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100)
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=team), size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100)
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=team), size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " (", games_won, "-", games_lost, ")")),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " (", games_ahead, ",", games_behind, ")")),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\na=", games_ahead, ", b=", games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggplot(team_summaries, aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(
label=expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team <- team_summaries$team
games_ahead
expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind)))
expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))
?expression
expression("%up%")
expression(paste("Plot of ", alpha^beta, " versus ", hat(mu)[0])))
a <- expression(paste("Plot of ", alpha^beta, " versus ", hat(mu)[0])))
a <- expression(paste("Plot of ", alpha^beta, " versus ", hat(mu)[0]))
a
team_summaries %>%
mutate(team_labels = expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))) %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=team_labels), size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
mutate(team_labels = expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))) %>%
%>% View
team_summaries %>%
mutate(team_labels = expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))) %>%
View
expression(paste0(team, "\n%up%", games_ahead, " %down%", games_behind))
?pmap
pmap(team_summaries[,c("team", "games_ahead", "games_behind")], function(t, a, b){
expression(paste0(t, "\n%up%", a, " %down%", b))
})
apply(team_summaries[,c("team", "games_ahead", "games_behind")], 1, function(row){
expression(paste0(row[1], "\n%up%", row[2], " %down%", row[3]))
})
apply(team_summaries[,c("team", "games_ahead", "games_behind")], 1, function(row){
expression(paste0(row[1], "\n%up%", row[2], " %down%", row[3]))
}) %>% as.vector
apply(team_summaries[,c("team", "games_ahead", "games_behind")], 1, function(row){
expression(paste0(row[1], "\n%up%", row[2], " %down%", row[3]))
}) %>% unlist
paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind))
paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind)
team_summaries %>%
mutate(team_labels =) %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind) %>%
sapply(expression)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
paste0(team, "\n", expression("%up%"), games_ahead,
" ", expression("%down%"), games_behind) %>%
sapply(expression)
paste0(team, "\n%up%", games_ahead,
" %down%", games_behind) %>%
sapply(expression))
paste0(team, "\n%up%", games_ahead,
" %down%", games_behind) %>%
sapply(expression)
paste0(team, "\n%up%", games_ahead,
" %down%", games_behind) \
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n%up%", games_ahead,
" %down%", games_behind)),
size=2, arse=T) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n%up%", games_ahead,
" %down%", games_behind)),
size=2, parse=T) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
?sprintf
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2, parse=T) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, "\n", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average"))
?geom_abline
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_abline(slope=-1, intercept=1)
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=2), color="gray")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg/abs_avg), y=lead_avg/abs_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=2), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=2), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point(aes(size=abs_avg), alpha=0.5) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point(aes(color=abs_avg), alpha=0.5) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point(aes(color=abs_avg, size=abs_avg), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit %/% abs average"),
y=expression("avg lead %/% abs average")) +
geom_hline(aes(yintercept=1), color="gray") +
geom_vline(aes(xintercept=1), color="gray") +
geom_abline(aes(slope=-1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=deficit_avg, y=lead_avg)) +
geom_point(aes(color=abs_avg, size=abs_avg), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=-1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg), y=lead_avg)) +
geom_point(aes(color=abs_avg, size=abs_avg), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg), y=lead_avg)) +
geom_point(aes(color=abs(deficit_avg)/lead_avg,
size=abs(deficit_avg)/lead_avg), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg), y=lead_avg)) +
geom_point(aes(color=lead_avg/abs(deficit_avg),
size=lead_avg/abs(deficit_avg)), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=1, intercept=0), color="gray", linetype="dashed")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg), y=lead_avg)) +
geom_point(aes(color=lead_avg/abs(deficit_avg),
size=lead_avg/abs(deficit_avg)), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=1, intercept=0), color="gray", linetype="dashed") +
labs(size="lead:deficit", color="lead:deficit")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=4) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggsave(paste0(savefolder, "comparison_winloss_updown.png"),
width=8, height=4.5)
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=2) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggsave(paste0(savefolder, "comparison_winloss_updown.png"),
width=8, height=4.5)
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=1.5) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
ggsave(paste0(savefolder, "comparison_winloss_updown.png"),
width=8, height=4.5)
team_summaries %>%
ggplot(aes(x=losebehind, y=winahead)) +
geom_point() +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=1.5) +
facet_wrap(~league) +
geom_hline(aes(yintercept=50), color="gray") +
geom_vline(aes(xintercept=50), color="gray") +
#  xlim(0,100) + ylim(0,100) +
labs(x="% games lost when behind at 15", y="% games won when ahead at 15")
team_summaries %>%
ggplot(aes(x=abs(deficit_avg), y=lead_avg)) +
geom_point(aes(color=lead_avg/abs(deficit_avg),
size=lead_avg/abs(deficit_avg)), alpha=0.8) +
theme_minimal() +
geom_text_repel(aes(label=paste0(team, " ", sprintf('\u2191'), games_ahead,
" ", sprintf('\u2193'), games_behind)),
size=1.5) +
facet_wrap(~league) +
labs(x=expression("avg deficit"),
y=expression("avg lead")) +
geom_abline(aes(slope=1, intercept=0), color="gray", linetype="dashed") +
labs(size="lead:deficit", color="lead:deficit")
ggsave(paste0(savefolder, "comparison_lead_deficit.png"),
width=8, height=4.5)
